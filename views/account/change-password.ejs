<%- include('../partials/head') %>
<%- include('../partials/header', { user: user }) %>
<%- include('../partials/navigation') %>

<main>
  <div class="password-change">
    <h1>Update Password</h1>

    <% if (messages && messages.length > 0) { %>
      <div class="messages">
        <% messages.forEach(function(message) { %>
          <div class="notice"><%= message %></div>
        <% }) %>
      </div>
    <% } %>

    <form action="/account/change-password" method="post" class="password-form">
      <fieldset>
        <legend>Change Your Password</legend>

        <input type="hidden" name="user_id" value="<%= user.id %>">

        <label for="password">New Password:</label>
        <input type="password" id="password" name="password" required
               minlength="8"
               pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
               title="Password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, one number, and one special character">

        <label for="confirm_password">Confirm New Password:</label>
        <input type="password" id="confirm_password" name="confirm_password" required>

        <input type="submit" value="Change Password" class="submit-btn">
      </fieldset>
    </form>

    <div class="password-requirements">
      <h3>Password Requirements:</h3>
      <ul>
        <li>At least 8 characters long</li>
        <li>Contains at least one uppercase letter</li>
        <li>Contains at least one lowercase letter</li>
        <li>Contains at least one number</li>
        <li>Contains at least one special character (@$!%*?&)</li>
      </ul>
    </div>

    <p>
      <a href="/inventory" class="back-link">‚Üê Back to Account Management</a>
    </p>
  </div>
</main>

<%- include('../partials/footer') %>

<style>
    main {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 80vh;
  background: #f5f7fa;
  padding: 2em 0;
}

.password-change {
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  padding: 2.5em 2em 2em 2em;
  max-width: 420px;
  width: 100%;
}

.password-change h1 {
  font-size: 2em;
  margin-bottom: 1em;
  color: #23395d;
  text-align: center;
}

.messages {
  margin-bottom: 1em;
}

.notice {
  background: #e7f3fe;
  color: #2176ae;
  border-left: 4px solid #2176ae;
  padding: 0.75em 1em;
  margin-bottom: 0.5em;
  border-radius: 4px;
  font-size: 1em;
}

.password-form fieldset {
  border: none;
  padding: 0;
  margin: 0 0 1.5em 0;
}

.password-form legend {
  font-weight: bold;
  color: #23395d;
  margin-bottom: 1em;
  font-size: 1.2em;
}

.password-form label {
  display: block;
  margin-bottom: 0.4em;
  font-weight: 500;
  color: #23395d;
}

.password-form input[type="password"] {
  width: 100%;
  padding: 0.6em;
  margin-bottom: 1.2em;
  border: 1px solid #bfc9d1;
  border-radius: 4px;
  font-size: 1em;
  background: #f9fafb;
  transition: border 0.2s;
}

.password-form input[type="password"]:focus {
  border-color: #2176ae;
  outline: none;
}

.submit-btn {
  background: #2176ae;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 0.75em 1.5em;
  font-size: 1em;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.2s;
  margin-top: 0.5em;
}

.submit-btn:hover {
  background: #17406d;
}

.password-requirements {
  background: #f4f7fa;
  border: 1px solid #e0e6ed;
  border-radius: 6px;
  padding: 1em 1.2em;
  margin-bottom: 1.2em;
}

.password-requirements h3 {
  margin-top: 0;
  font-size: 1em;
  color: #23395d;
  margin-bottom: 0.5em;
}

.password-requirements ul {
  padding-left: 1.2em;
  margin: 0;
  font-size: 0.97em;
  color: #3b4a5a;
}

.password-requirements li {
  margin-bottom: 0.3em;
}

.back-link {
  display: inline-block;
  margin-top: 1.2em;
  color: #2176ae;
  text-decoration: none;
  font-weight: 500;
  transition: color 0.2s;
}

.back-link:hover {
  color: #17406d;
  text-decoration: underline;
}
</style>
